id: xss-react-component
name: "XSS Vulnerability in React Comment Component"
description: "PR adds HTML rendering support to a comment display component, introducing XSS vulnerabilities through dangerouslySetInnerHTML."
language: typescript
difficulty: medium
categories: [security, xss]

pr:
  title: "Add rich text support for comments"
  description: "Added support for HTML content in comments to allow rich text formatting."

issues:
  - id: xss-comment-content
    severity: critical
    category: security
    file: src/CommentDisplay.tsx
    line_start: 18
    line_end: 20
    title: "XSS vulnerability via dangerouslySetInnerHTML on user content"
    description: "User-provided comment content is rendered as HTML without sanitization, allowing XSS attacks through malicious scripts in comments."
    keywords: [xss, dangerouslySetInnerHTML, sanitize, dompurify, escape]

  - id: xss-author-name
    severity: critical
    category: security
    file: src/CommentDisplay.tsx
    line_start: 30
    line_end: 30
    title: "XSS vulnerability in author name rendering"
    description: "The author name is rendered using dangerouslySetInnerHTML without any sanitization, allowing XSS attacks through malicious usernames."
    keywords: [xss, dangerouslySetInnerHTML, sanitize, escape, username]

  - id: missing-validation
    severity: high
    category: security
    file: src/CommentDisplay.tsx
    line_start: 17
    line_end: 21
    title: "No input validation for HTML content"
    description: "The isHtml flag allows HTML rendering without any validation or sanitization library like DOMPurify."
    keywords: [validation, sanitization, dompurify, security]